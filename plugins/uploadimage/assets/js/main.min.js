document.getElementById("toolbar-plugins").innerHTML='<input type="file" id="image-upload" accept="image/jpg, image/jpeg, image/png" /><input type="button" id="image-upload-button" /><div id="image-upload-progress" style="background-color: yellow;"><span id="image-upload-percentage"></span> % uploaded</div><div id="image-upload-error"></div>',document.querySelector("#image-upload-button").addEventListener("click",function(){document.querySelector("#image-upload").click()}),document.querySelector("#image-upload").addEventListener("change",function(){var e,o=new FormData;o.append("file",document.querySelector("#image-upload").files[0]),(e=new XMLHttpRequest).addEventListener("load",function(o){if(document.querySelector("#image-upload-progress").style.display="none",console.log(e),e.response){if(0==e.response.error){var r=window.getSelection().getRangeAt(0),t=r.createContextualFragment('<img src="'+e.response.image+'">');r.insertNode(t)}1==e.response.error&&(document.querySelector("#image-upload-error").innerText=e.response.message,document.querySelector("#image-upload-error").style.display="block")}else document.querySelector("#image-upload-error").innerText="Upload error",document.querySelector("#image-upload-error").style.display="block"}),e.upload.addEventListener("progress",function(e){var o=e.loaded/e.total*100;document.querySelector("#image-upload-percentage").innerText=o,document.querySelector("#image-upload-progress").style.display="block"}),e.responseType="json",e.open("post","http://localhost/assets/plugins/btxeditor/plugins/uploadimage/upload.php"),e.send(o)});